<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Educational Page</title>
    <!-- Include Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: #F5F6FA; /* Light grayish-blue background */
            color: #333333; /* Primary text color */
            padding: 20px;
        }

        /* Header Section */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 700;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE and Edge */
        }

        .nav-tabs::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        .nav-tabs button {
            background: #333333; /* Dark gray */
            color: #FFFFFF;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
        }

        .nav-tabs button.active {
            background: #666666; /* Medium gray */
        }

        /* Dashboard Section */
        .dashboard {
            margin-bottom: 40px;
        }

        .dashboard h2 {
            font-size: 20px;
            margin-bottom: 20px;
        }

        .charts-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: space-between;
        }

        .chart-wrapper {
            background: #FFFFFF;
            border-radius: 12px;
            padding: 20px;
            width: 48%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .chart-wrapper canvas {
            max-height: 300px;
        }

        /* My Courses Section */
        .my-courses {
            margin-bottom: 40px;
        }

        .my-courses h2 {
            font-size: 20px;
            margin-bottom: 20px;
        }

        .course-list {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .course-card {
            background: #FFFFFF; /* White */
            border-radius: 12px;
            padding: 20px;
            width: 300px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .course-card .category {
            background: #333333; /* Dark gray */
            color: #FFFFFF;
            border-radius: 20px;
            padding: 5px 10px;
            font-size: 12px;
            display: inline-block;
            margin-bottom: 10px;
        }

        .course-card h3 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .course-card .progress {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .course-card .progress-bar {
            width: 100px;
            height: 8px;
            background: #E0E0E0; /* Light gray */
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }

        .course-card .progress-bar .fill {
            height: 100%;
            background: #28C76F; /* Green */
            position: absolute;
            top: 0;
            left: 0;
        }

        .course-card .students {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
        }

        .course-card .students .avatars {
            display: flex;
        }

        .course-card .students .avatar {
            width: 20px;
            height: 20px;
            background: #CCCCCC; /* Gray */
            border-radius: 50%;
            margin-left: -5px;
            border: 1px solid #FFFFFF;
        }

        .course-card .students .count {
            background: #FFD700; /* Yellow */
            color: #333333;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            margin-left: -5px;
            border: 1px solid #FFFFFF;
        }

        .course-card .continue-btn {
            background: #FF5733; /* Orange */
            color: #FFFFFF;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
        }

        .course-card .favorite-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
        }

        /* My Next Lessons and More Courses Section */
        .my-next-lessons-section {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-bottom: 40px;
        }

        .lessons-list, .more-courses {
            border-radius: 12px;
            padding: 20px;
        }

        .lessons-list {
            background: #FFFFFF; /* White */
            flex: 1;
            max-height: 300px;
            overflow-y: hidden;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .lessons-list.scrollable {
            overflow-y: auto;
        }

        .lessons-list::-webkit-scrollbar {
            display: none;
        }

        .more-courses {
            background: #333333; /* Dark gray */
            color: #FFFFFF;
            flex: 1;
            max-height: 300px;
            overflow-y: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .more-courses::-webkit-scrollbar {
            display: none;
        }

        .lessons-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .lessons-list h2, .more-courses h2 {
            font-size: 20px;
        }

        .lessons-table {
            width: 100%;
            border-collapse: collapse;
        }

        .lessons-table th, .lessons-table td {
            padding: 10px;
            text-align: left;
        }

        .lessons-table th {
            font-weight: 700;
            color: #666666; /* Light gray */
        }

        .lessons-table td {
            font-size: 14px;
        }

        .lessons-table .teacher {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .lessons-table .teacher .avatar {
            width: 30px;
            height: 30px;
            background: #333333; /* Dark gray */
            border-radius: 50%;
        }

        .view-all-lessons {
            color: #FF5733; /* Orange */
            text-decoration: none;
            font-size: 14px;
        }

        /* More Courses Section */
        .more-courses .course-card {
            background: #444444; /* Slightly lighter gray */
            color: #FFFFFF;
            margin-bottom: 20px;
        }

        .more-courses .course-card .category {
            background: #666666; /* Medium gray */
        }

        .more-courses .course-card .progress-bar .fill {
            background: #FF5733; /* Orange */
        }

        .more-courses .course-card .students .count {
            background: #FFD700; /* Yellow */
            color: #333333;
        }

        .more-courses .course-card .continue-btn {
            background: #FF5733; /* Orange */
        }

        /* Popup Styles */
        .popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .popup-content {
            background: #FFFFFF;
            border-radius: 12px;
            padding: 20px;
            width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .popup-content h3 {
            font-size: 20px;
            margin-bottom: 20px;
        }

        .popup-content .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
        }

        .popup-content .lesson-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #E0E0E0;
        }

        .popup-content .lesson-item.completed {
            color: #666666; /* Light gray */
        }

        .popup-content .lesson-item .complete-btn {
            background: #28C76F; /* Green */
            color: #FFFFFF;
            border: none;
            border-radius: 20px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 12px;
        }

        .popup-content .lesson-item .completed-btn {
            background: none;
            border: none;
            color: #666666; /* Light gray */
            font-size: 12px;
            font-weight: 500;
            cursor: default;
        }

        /* Responsiveness */
        @media (max-width: 768px) {
            .course-list {
                flex-direction: column;
            }

            .course-card {
                width: 100%;
            }

            .my-next-lessons-section {
                flex-direction: column;
                gap: 20px;
            }

            .lessons-list, .more-courses {
                flex: 1;
            }

            .lessons-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .charts-container {
                flex-direction: column;
            }

            .chart-wrapper {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <div class="header">
        <h1>My courses</h1>
        <div class="nav-tabs" id="navTabs">
            <button class="active" onclick="filterCourses('All courses')">All courses</button>
            <button onclick="filterCourses('Marketing')">Marketing</button>
            <button onclick="filterCourses('Computer Science')">Computer Science</button>
            <button onclick="filterCourses('Psychology')">Psychology</button>
        </div>
    </div>

    <!-- My Courses Section -->
    <div class="my-courses">
        <h2>My courses</h2>
        <div class="course-list" id="courseList"></div>
    </div>

    <!-- Dashboard Section -->
    <div class="dashboard">
        <h2>Dashboard</h2>
        <div class="charts-container">
            <div class="chart-wrapper">
                <canvas id="completionPieChart"></canvas>
            </div>
            <div class="chart-wrapper">
                <canvas id="progressBarChart"></canvas>
            </div>
        </div>
    </div>

    <!-- My Next Lessons and More Courses Section -->
    <div class="my-next-lessons-section">
        <div class="lessons-list" id="lessonsList">
            <div class="lessons-header">
                <h2>My next lessons</h2>
                <a href="#" class="view-all-lessons" id="viewAllLessonsLink" onclick="toggleAllLessons()">View all lessons</a>
            </div>
            <table class="lessons-table" id="lessonsTable">
                <thead>
                    <tr>
                        <th>Lesson</th>
                        <th>Teacher</th>
                        <th>Duration</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="more-courses">
            <h2>More Courses</h2>
            <div id="moreCourses"></div>
        </div>
    </div>

    <!-- Popup for Course Progress -->
    <div class="popup" id="coursePopup">
        <div class="popup-content">
            <button class="close-btn" onclick="closePopup('coursePopup')">✖</button>
            <h3 id="popupCourseTitle"></h3>
            <div id="popupLessons"></div>
        </div>
    </div>

    <script>
        // Data Structure
        let myCourses = [
            {
                id: 1,
                category: "Marketing",
                title: "Creative Writing for Beginners",
                lessons: [
                    { title: "Intro to Creative Writing", teacher: "Conner Garcia", duration: "22 min", completed: false },
                    { title: "Developing Your Writing Style", teacher: "Conner Garcia", duration: "30 min", completed: false },
                    { title: "Crafting Engaging Stories", teacher: "Conner Garcia", duration: "25 min", completed: false },
                    { title: "Writing Effective Dialogues", teacher: "Conner Garcia", duration: "20 min", completed: false },
                    { title: "Editing and Revising", teacher: "Conner Garcia", duration: "28 min", completed: false },
                    { title: "Publishing Your Work", teacher: "Conner Garcia", duration: "35 min", completed: false }
                ],
                students: 120,
                favoritedAt: null
            },
            {
                id: 2,
                category: "Computer Science",
                title: "Digital Illustration with Adobe Illustrator",
                lessons: [
                    { title: "Getting to Know Adobe Illustrator", teacher: "Tony Ware", duration: "1h 08 min", completed: false },
                    { title: "Basic Tools and Techniques", teacher: "Tony Ware", duration: "45 min", completed: false },
                    { title: "Creating Your First Illustration", teacher: "Tony Ware", duration: "50 min", completed: false },
                    { title: "Working with Layers", teacher: "Tony Ware", duration: "40 min", completed: false },
                    { title: "Advanced Illustration Techniques", teacher: "Tony Ware", duration: "55 min", completed: false },
                    { title: "Exporting Your Artwork", teacher: "Tony Ware", duration: "30 min", completed: false },
                    { title: "Illustrating for Clients", teacher: "Tony Ware", duration: "1h 00 min", completed: false }
                ],
                students: 80,
                favoritedAt: null
            },
            {
                id: 3,
                category: "Psychology",
                title: "Public Speaking and Leadership",
                lessons: [
                    { title: "Foundations of Public Speaking", teacher: "Saira Goodman", duration: "40 min", completed: false },
                    { title: "Understanding Audience Psychology", teacher: "Mya Guzman", duration: "26 min", completed: false },
                    { title: "The Importance of Self-Reflection", teacher: "Zohalib Osborn", duration: "23 min", completed: false },
                    { title: "Building Confidence in Speaking", teacher: "Saira Goodman", duration: "35 min", completed: false },
                    { title: "Leadership Through Communication", teacher: "Mya Guzman", duration: "45 min", completed: false },
                    { title: "Handling Q&A Sessions", teacher: "Zohalib Osborn", duration: "30 min", completed: false },
                    { title: "Inspiring Your Audience", teacher: "Saira Goodman", duration: "50 min", completed: false },
                    { title: "Effective Body Language", teacher: "Mya Guzman", duration: "28 min", completed: false }
                ],
                students: 24,
                favoritedAt: null
            }
        ];

        let moreCourses = [
            {
                id: 4,
                category: "Design",
                title: "UI/UX Design Fundamentals",
                lessons: [
                    { title: "Introduction to UI/UX", teacher: "Emma Stone", duration: "30 min", completed: false },
                    { title: "User Research Basics", teacher: "Emma Stone", duration: "35 min", completed: false },
                    { title: "Wireframing Techniques", teacher: "Emma Stone", duration: "40 min", completed: false },
                    { title: "Prototyping with Figma", teacher: "Emma Stone", duration: "45 min", completed: false },
                    { title: "Usability Testing", teacher: "Emma Stone", duration: "38 min", completed: false },
                    { title: "Designing for Accessibility", teacher: "Emma Stone", duration: "50 min", completed: false },
                    { title: "Visual Hierarchy in Design", teacher: "Emma Stone", duration: "30 min", completed: false },
                    { title: "Design Systems", teacher: "Emma Stone", duration: "40 min", completed: false }
                ],
                students: 95,
                favoritedAt: null
            },
            {
                id: 5,
                category: "Business",
                title: "Entrepreneurship 101",
                lessons: [
                    { title: "What is Entrepreneurship?", teacher: "Mark Evans", duration: "25 min", completed: false },
                    { title: "Idea Validation", teacher: "Mark Evans", duration: "30 min", completed: false },
                    { title: "Business Model Canvas", teacher: "Mark Evans", duration: "35 min", completed: false },
                    { title: "Funding Your Startup", teacher: "Mark Evans", duration: "40 min", completed: false },
                    { title: "Marketing for Startups", teacher: "Mark Evans", duration: "45 min", completed: false },
                    { title: "Scaling Your Business", teacher: "Mark Evans", duration: "50 min", completed: false },
                    { title: "Leadership in Startups", teacher: "Mark Evans", duration: "38 min", completed: false },
                    { title: "Exit Strategies", teacher: "Mark Evans", duration: "30 min", completed: false },
                    { title: "Case Studies in Entrepreneurship", teacher: "Mark Evans", duration: "40 min", completed: false }
                ],
                students: 120,
                favoritedAt: null
            },
            {
                id: 6,
                category: "Health",
                title: "Nutrition and Wellness",
                lessons: [
                    { title: "Basics of Nutrition", teacher: "Dr. Sarah Lee", duration: "28 min", completed: false },
                    { title: "Macronutrients Explained", teacher: "Dr. Sarah Lee", duration: "32 min", completed: false },
                    { title: "Micronutrients and Health", teacher: "Dr. Sarah Lee", duration: "35 min", completed: false },
                    { title: "Meal Planning for Wellness", teacher: "Dr. Sarah Lee", duration: "40 min", completed: false },
                    { title: "Understanding Diets", teacher: "Dr. Sarah Lee", duration: "45 min", completed: false },
                    { title: "Hydration and Health", teacher: "Dr. Sarah Lee", duration: "30 min", completed: false },
                    { title: "Nutrition for Mental Health", teacher: "Dr. Sarah Lee", duration: "38 min", completed: false },
                    { title: "Supplements vs Whole Foods", teacher: "Dr. Sarah Lee", duration: "35 min", completed: false },
                    { title: "Sustainable Eating Habits", teacher: "Dr. Sarah Lee", duration: "40 min", completed: false },
                    { title: "Nutrition Myths Debunked", teacher: "Dr. Sarah Lee", duration: "50 min", completed: false }
                ],
                students: 85,
                favoritedAt: null
            }
        ];

        let currentFilter = "All courses";
        let allLessonsVisible = false;
        let completionPieChart = null;
        let progressBarChart = null;

        // Render Navigation Bar
        function renderNavTabs() {
            const navTabs = document.getElementById("navTabs");
            navTabs.innerHTML = `<button class="${currentFilter === 'All courses' ? 'active' : ''}" onclick="filterCourses('All courses')">All courses</button>`;
            
            const categories = [...new Set(myCourses.map(course => course.category))];
            categories.forEach(category => {
                navTabs.innerHTML += `<button class="${currentFilter === category ? 'active' : ''}" onclick="filterCourses('${category}')">${category}</button>`;
            });
        }

        // Render Courses
        function renderCourses() {
            const courseList = document.getElementById("courseList");
            courseList.innerHTML = "";

            let filteredCourses = myCourses.filter(course => 
                currentFilter === "All courses" || course.category === currentFilter
            );

            filteredCourses.sort((a, b) => {
                if (a.favoritedAt && b.favoritedAt) {
                    return b.favoritedAt - a.favoritedAt;
                }
                if (a.favoritedAt) return -1;
                if (b.favoritedAt) return 1;
                return 0;
            });

            filteredCourses.forEach(course => {
                const completedLessons = course.lessons.filter(lesson => lesson.completed).length;
                const totalLessons = course.lessons.length;
                const progressPercent = Math.round((completedLessons / totalLessons) * 100);

                const courseCard = document.createElement("div");
                courseCard.className = "course-card";
                courseCard.innerHTML = `
                    <span class="category">${course.category}</span>
                    <button class="favorite-btn" onclick="toggleFavorite(${course.id})">
                        ${course.favoritedAt ? "★" : "☆"}
                    </button>
                    <h3>${course.title}</h3>
                    <div class="progress">
                        <span>Progress</span>
                        <div class="progress-bar">
                            <div class="fill" style="width: ${progressPercent}%"></div>
                        </div>
                        <span>${completedLessons}/${totalLessons} lessons</span>
                    </div>
                    <div class="students">
                        <div class="avatars">
                            <div class="avatar"></div>
                            <div class="avatar"></div>
                            <div class="avatar"></div>
                        </div>
                        <span class="count">+${course.students}</span>
                    </div>
                    <button class="continue-btn" onclick="showCoursePopup(${course.id}, 'myCourses')">Continue</button>
                `;
                courseList.appendChild(courseCard);
            });

            // Update dashboard charts after rendering courses
            renderDashboard();
        }

        // Filter Courses
        function filterCourses(category) {
            currentFilter = category;
            renderCourses();
            renderNavTabs();
        }

        // Toggle Favorite
        function toggleFavorite(courseId) {
            const course = myCourses.find(c => c.id === courseId) || moreCourses.find(c => c.id === courseId);
            if (course.favoritedAt) {
                course.favoritedAt = null;
            } else {
                course.favoritedAt = Date.now();
            }
            renderCourses();
            renderMoreCourses();
        }

        // Show Course Popup
        function showCoursePopup(courseId, source) {
            const course = (source === 'myCourses' ? myCourses : moreCourses).find(c => c.id === courseId);
            const popup = document.getElementById("coursePopup");
            const popupTitle = document.getElementById("popupCourseTitle");
            const popupLessons = document.getElementById("popupLessons");

            popupTitle.textContent = course.title;
            popupLessons.innerHTML = "";

            course.lessons.forEach((lesson, index) => {
                const lessonItem = document.createElement("div");
                lessonItem.className = `lesson-item ${lesson.completed ? "completed" : ""}`;
                lessonItem.innerHTML = `
                    <span>${lesson.title}</span>
                    ${!lesson.completed ? 
                        `<button class="complete-btn" onclick="markLessonCompleted(${courseId}, ${index}, '${source}')">Complete</button>` : 
                        `<button class="completed-btn">Completed</button>`}
                `;
                popupLessons.appendChild(lessonItem);
            });

            popup.style.display = "flex";
        }

        // Mark Lesson as Completed
        function markLessonCompleted(courseId, lessonIndex, source) {
            const course = (source === 'myCourses' ? myCourses : moreCourses).find(c => c.id === courseId);
            course.lessons[lessonIndex].completed = true;
            renderCourses();
            renderNextLessons();
            showCoursePopup(courseId, source);
        }

        // Close Popup
        function closePopup(popupId) {
            document.getElementById(popupId).style.display = "none";
        }

        // Render Next Lessons
        function renderNextLessons() {
            const lessonsTable = document.querySelector("#lessonsTable tbody");
            const lessonsList = document.getElementById("lessonsList");
            const viewAllLessonsLink = document.getElementById("viewAllLessonsLink");
            lessonsTable.innerHTML = "";

            let uncompletedLessons = [];
            myCourses.forEach(course => {
                course.lessons.forEach(lesson => {
                    if (!lesson.completed) {
                        uncompletedLessons.push({ courseTitle: course.title, ...lesson });
                    }
                });
            });

            if (uncompletedLessons.length === 0) {
                const row = document.createElement("tr");
                row.innerHTML = `<td colspan="3">No uncompleted lessons available.</td>`;
                lessonsTable.appendChild(row);
                viewAllLessonsLink.style.display = "none";
                return;
            }

            uncompletedLessons.sort(() => Math.random() - 0.5);

            const lessonsToShow = allLessonsVisible ? uncompletedLessons : uncompletedLessons.slice(0, 5);
            lessonsToShow.forEach(lesson => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${lesson.title}</td>
                    <td class="teacher">
                        <div class="avatar"></div>
                        ${lesson.teacher}
                    </td>
                    <td>${lesson.duration}</td>
                `;
                lessonsTable.appendChild(row);
            });

            // Always show the "View all lessons" link if there are more lessons to show
            viewAllLessonsLink.style.display = uncompletedLessons.length > 5 ? "inline-block" : "none";
            viewAllLessonsLink.textContent = allLessonsVisible ? "Show less" : "View all lessons";

            lessonsList.classList.toggle("scrollable", allLessonsVisible);
        }

        // Toggle All Lessons Visibility
        function toggleAllLessons() {
            allLessonsVisible = !allLessonsVisible;
            renderNextLessons();
        }

        // Render More Courses
        function renderMoreCourses() {
            const moreCoursesContainer = document.getElementById("moreCourses");
            moreCoursesContainer.innerHTML = "";

            moreCourses.forEach(course => {
                const completedLessons = course.lessons.filter(lesson => lesson.completed).length;
                const totalLessons = course.lessons.length;
                const progressPercent = Math.round((completedLessons / totalLessons) * 100);

                const courseCard = document.createElement("div");
                courseCard.className = "course-card";
                courseCard.innerHTML = `
                    <span class="category">${course.category}</span>
                    <button class="favorite-btn" onclick="toggleFavorite(${course.id})">
                        ${course.favoritedAt ? "★" : "☆"}
                    </button>
                    <h3>${course.title}</h3>
                    <div class="progress">
                        <span>Progress</span>
                        <div class="progress-bar">
                            <div class="fill" style="width: ${progressPercent}%"></div>
                        </div>
                        <span>${completedLessons}/${totalLessons} lessons</span>
                    </div>
                    <div class="students">
                        <div class="avatars">
                            <div class="avatar"></div>
                            <div class="avatar"></div>
                            <div class="avatar"></div>
                        </div>
                        <span class="count">+${course.students}</span>
                    </div>
                    <button class="continue-btn" onclick="addCourseToMyCourses(${course.id})">Add Course</button>
                `;
                moreCoursesContainer.appendChild(courseCard);
            });
        }

        // Add Course to My Courses
        function addCourseToMyCourses(courseId) {
            const courseIndex = moreCourses.findIndex(c => c.id === courseId);
            if (courseIndex === -1) return;

            const course = moreCourses[courseIndex];
            myCourses.push(course);
            moreCourses.splice(courseIndex, 1);

            // Update Navigation Bar
            const categories = [...new Set(myCourses.map(c => c.category))];
            const navTabs = document.getElementById("navTabs");
            const existingCategories = Array.from(navTabs.children).map(btn => btn.textContent.toLowerCase());
            if (!existingCategories.includes(course.category.toLowerCase()) && course.category !== "All courses") {
                const newButton = document.createElement("button");
                newButton.textContent = course.category;
                newButton.onclick = () => filterCourses(course.category);
                navTabs.appendChild(newButton);
            }

            renderCourses();
            renderMoreCourses();
            renderNextLessons();
        }

        // Render Dashboard Charts
        function renderDashboard() {
            // Calculate data for the charts
            let totalCompleted = 0;
            let totalUncompleted = 0;
            const progressData = [];
            const courseLabels = [];

            myCourses.forEach(course => {
                const completedLessons = course.lessons.filter(lesson => lesson.completed).length;
                const totalLessons = course.lessons.length;
                const uncompletedLessons = totalLessons - completedLessons;
                const progressPercent = Math.round((completedLessons / totalLessons) * 100);

                totalCompleted += completedLessons;
                totalUncompleted += uncompletedLessons;
                progressData.push(progressPercent);
                courseLabels.push(course.title);
            });

            // Destroy existing charts if they exist to prevent overlap
            if (completionPieChart) {
                completionPieChart.destroy();
            }
            if (progressBarChart) {
                progressBarChart.destroy();
            }

            // Pie Chart: Completed vs Uncompleted Lessons
            const pieCtx = document.getElementById('completionPieChart').getContext('2d');
            completionPieChart = new Chart(pieCtx, {
                type: 'pie',
                data: {
                    labels: ['Completed', 'Uncompleted'],
                    datasets: [{
                        data: [totalCompleted, totalUncompleted],
                        backgroundColor: ['#28C76F', '#FF5733'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: 'Lesson Completion Overview'
                        }
                    }
                }
            });

            // Bar Chart: Progress per Course
            const barCtx = document.getElementById('progressBarChart').getContext('2d');
            progressBarChart = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: courseLabels,
                    datasets: [{
                        label: 'Progress (%)',
                        data: progressData,
                        backgroundColor: '#28C76F',
                        borderColor: '#28C76F',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Progress (%)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Courses'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Course Progress'
                        }
                    }
                }
            });
        }

        // Initial Render
        renderNavTabs();
        renderCourses();
        renderNextLessons();
        renderMoreCourses();
        renderDashboard();
    </script>
</body>
</html>